@model WebDeshiHutBazar.GroupPanelTemplateDisplayViewModel
@{
    var categoryID = "";
    var subCatID = "";
    var viewMoreURL = "";
    List<WebDeshiHutBazar.TemplateDisplayViewModel> listProducts = null;
    bool shouldProceed = true;
    if (Model.ListGroupPost != null && Model.ListGroupPost.Count(a => a.Image != null) > 6)
    {
        listProducts = Model.ListGroupPost.Where(a=>a.Image != null).ToList();
        categoryID = Model.ListGroupPost[0].CategoryID.ToString();
        subCatID = Model.ListGroupPost[0].CategoryID.ToString();
        viewMoreURL = Url.Action("Market", "CategoryMarket", new { subcategoryid = subCatID, pageNumber = "1" });
    }
    else
    {
        shouldProceed = false;
    }
}
@if (shouldProceed == true)
{
    <div class="container @categoryID container-gap">
        @if (!string.IsNullOrEmpty(Model.GroupPanelTitle))
        {
            <div class="row">
                <div class="col-md-10 col-xs-9 col-sm-9 col-lg-10">
                    <h4 class="title blue-text">
                        @Model.GroupPanelTitle
                    </h4>
                </div>
                <div class="col-md-2 col-xs-3 col-sm-3 col-lg-2 pull-right">
                    <a href="@viewMoreURL"
                       role="button">
                        @Common.Language.LanguageDefault.ViewMore
                    </a>
                </div>
            </div>
        }
        <div class="row">
            @foreach (var product in listProducts.ToList())
            {
                <div class="col-md-2 col-sm-2 col-lg-2 col-xs-6 white-bg">
                    @if (product.PostType == Common.EnumPostType.AdSpace)
                    {
                        <a href="@product.WebsiteUrl" target="_blank" class="thumbnail only-image">
                            @if (product.Image != null)
                            {
                                @Html.Partial("../Shared/ProductTemplates/_SixerImage", product.Image);
                            }
                            else
                            {
                                @Html.Partial("../Shared/ProductTemplates/_SixerImage", new byte[1]);
                            }
                        </a>
                        <div class="caption text-center" style="margin-bottom:10px;">
                            <div class="truncate blue-text" style="margin-bottom:3px;">
                                @product.Title
                            </div>
                            <div class="truncate sponsor" style="margin-bottom:3px;">
                                SPONSORED
                            </div>
                        </div>
                    }
                    else if (product.PostType == Common.EnumPostType.FabiaService)
                    {
                        <a href="@product.PostItemDetailViewUrl" target="_blank" class="thumbnail only-image">
                            @if (product.Image != null)
                            {
                                @Html.Partial("../Shared/ProductTemplates/_SixerImage", product.Image);
                            }
                            else
                            {
                                @Html.Partial("../Shared/ProductTemplates/_SixerImage", new byte[1]);
                            }
                        </a>
                        <div class="caption text-center" style="margin-bottom:10px;">
                            <div class="truncate blue-text" style="margin-bottom:3px;">
                                @product.Title
                            </div>
                            <div class="fabia-service truncate" style="margin-bottom:3px;">
                                FABIA SERVICE
                            </div>
                        </div>
                    }
                    else if (product.PostType == Common.EnumPostType.ShortVideo)
                    {
                        <a class="thumbnail only-image">
                            @if (!string.IsNullOrEmpty(product.WebsiteUrl))
                            {
                                <iframe style="width:100%;height:200px;max-height:200px;min-height:200px;padding:0px;margin:0px;"
                                        src="https://www.youtube.com/embed/@product.WebsiteUrl.Trim()"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen></iframe>
                            }
                        </a>
                        <div class="caption text-center" style="margin-bottom:10px;">
                            <div class="truncate blue-text" style="margin-bottom:3px;">
                                @product.Title
                            </div>
                        </div>
                    }
                    else if (product.PostType == Common.EnumPostType.ShortNote)
                    {
                        <div class="caption text-center" style="margin-bottom:10px;">
                            <div class="truncate" style="margin-bottom:3px;">
                                <h4 class="sub-title blue-text">
                                    @product.Title
                                </h4>
                            </div>
                            <div class="info text-justify star-shortnote blue-text">
                                @product.Description
                            </div>
                        </div>
                    }
                    else
                    {
                        <a href="@product.PostItemDetailViewUrl" target="_blank" class="thumbnail only-image">
                            @if (product.Image != null)
                            {
                                @Html.Partial("../Shared/ProductTemplates/_SixerImage", product.Image);
                            }
                            else
                            {
                                @Html.Partial("../Shared/ProductTemplates/_SixerImage", new byte[1]);
                            }
                        </a>
                        <div class="caption text-center" style="margin-bottom:10px;">
                            <div class="truncate blue-text" style="margin-bottom:3px;">
                                @product.Title
                            </div>
                            <div class="home-currency-font-color" style="margin-bottom:3px;">
                                @product.FormattedPriceValue
                            </div>
                            @*@if (product.ShowCartButton)
                            {
                                <div class="add-to-cart sub-content" data-id="@product.PostID">
                                    ADD TO CART
                                </div>
                            }*@
                        </div>
                    }
                </div>
            }
        </div>
    </div>
}







































@{
    var shouldDisplayContent = false;
    long categoryID = 0;
    if (Model.ListGroupPost != null &&
        Model.ListGroupPost.Count > 0 &&
        Model.Column.HasValue &&
        (int)Model.Column <= Model.ListGroupPost.Count)
    {
        categoryID = Model.ListGroupPost[0].CategoryID;
        shouldDisplayContent = true;
    }
}
@if (shouldDisplayContent)
{
    <div class="panel panel-default @categoryID card-form" style="margin-bottom:38px;">
        @if (!string.IsNullOrEmpty(Model.GroupPanelTitle))
        {
            <div class="panel-heading" style="padding:5px;margin-bottom:15px;">
                <h3 class="sub-title" style="padding:3px;line-height:20px;">
                    @Model.GroupPanelTitle
                    <span style="margin-left:10px;padding:5px;">
                        
                    </span>
                </h3>
            </div>
        }
        <div class="panel-body">
            <div class="panel-content">
                <div class="row home-row">
                    @foreach (var postItem in Model.ListGroupPost)
                    {
                        var postType = "";
                        postItem.ImageCategoryClass = Model.ImageCategoryClass;
                        postItem.ColumnClass = Model.ColumnClass;
                        if (postItem.PostType == Common.EnumPostType.Post)
                        {
                            postType = "_Post";
                        }
                        else if (postItem.PostType == Common.EnumPostType.AdSpace)
                        {
                            postType = "_ADSpace";
                        }
                        else if (postItem.PostType == Common.EnumPostType.FabiaService)
                        {
                            postType = "_FabiaService";
                        }
                        else if (postItem.PostType == Common.EnumPostType.ShortNote)
                        {
                            postType = "_ShortNote";
                        }
                        else if (postItem.PostType == Common.EnumPostType.ShortVideo)
                        {
                            postType = "_ShortVideo";
                        }
                        <div class="@Model.ColumnClass home-single-item">
                            @Html.Partial("../Shared/DesktopPostType/" + postType, postItem)
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}
